<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.133.1">
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Create network resources.tf file :: Two-Tier Architecture in AWS using Terraform</title>

    
    <link href="/css/nucleus.css?1725202854" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1725202854" rel="stylesheet">
    <link href="/css/hybrid.css?1725202854" rel="stylesheet">
    <link href="/css/featherlight.min.css?1725202854" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1725202854" rel="stylesheet">
    <link href="/css/auto-complete.css?1725202854" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1725202854" rel="stylesheet">
    <link href="/css/theme.css?1725202854" rel="stylesheet">
    <link href="/css/tabs.css?1725202854" rel="stylesheet">
    <link href="/css/hugo-theme.css?1725202854" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1725202854"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/level-second/page-2-b/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1725202854"></script>
<script type="text/javascript" src="/js/auto-complete.js?1725202854"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/localhost:1313\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1725202854"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/level-one/" title="Overview" class="dd-item
        
        
        
        ">
      <a href="/level-one/">
          <b>1. </b>Overview
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/level-second/" title="Terraform" class="dd-item
        parent
        
        
        ">
      <a href="/level-second/">
          <b>2. </b>Terraform
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/level-second/page-2-a/" title="Create provider.tf file" class="dd-item ">
        <a href="/level-second/page-2-a/">
        <b>2.1 </b>Create provider.tf file
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/level-second/page-2-b/" title="Create network resources.tf file" class="dd-item active">
        <a href="/level-second/page-2-b/">
        <b>2.2 </b>Create network resources.tf file
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/level-second/page-2-c/" title="Create security resources.tf file" class="dd-item ">
        <a href="/level-second/page-2-c/">
        <b>2.3 </b>Create security resources.tf file
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/level-second/page-2-d/" title="Create ec2-resources.tf file" class="dd-item ">
        <a href="/level-second/page-2-d/">
        <b>2.4 </b>Create ec2-resources.tf file
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/level-second/page-2-e/" title="Create db-resources.tf file" class="dd-item ">
        <a href="/level-second/page-2-e/">
        <b>2.5 </b>Create db-resources.tf file
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/level-second/page-2-f/" title="Let&#39;s deploy!" class="dd-item ">
        <a href="/level-second/page-2-f/">
        <b>2.6 </b>Let&#39;s deploy!
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/level-three/" title="Go to the AWS console and verify" class="dd-item
        
        
        
        ">
      <a href="/level-three/">
          <b>3. </b>Go to the AWS console and verify
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/level-four/" title="Clean up resource" class="dd-item
        
        
        
        ">
      <a href="/level-four/">
          <b>4. </b>Clean up resource
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/level-five/" title="Closing Remarks: Your Journey with AWS and Terraform" class="dd-item
        
        
        
        ">
      <a href="/level-five/">
          <b>5. </b>Closing Remarks: Your Journey with AWS and Terraform
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Two-Tier Architecture in AWS using Terraform</a> > <a href='/level-second/'>Terraform</a> > Create network resources.tf file
          
        
          
        
          
        
                 
                  </span>
                </div>
                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
          <div id="chapter">
        
        <div id="body-inner">
          

        


<h2 id="2create-network-resourcestf-file">2.Create network resources.tf file</h2>
<p>When working with Terraform, one of the most important files you’ll need to create is the network_resources.tf file. This file typically contains the configuration for the network infrastructure that your application will require to function properly. This can include the creation of a Virtual Private Cloud (VPC), which serves as an isolated network environment for your application, as well as the configuration of subnets, an internet gateway, route tables, and load balancers.</p>
<p>Within the network_resources.tf file, you may define two public subnets and two private subnets, each with its own unique configurations. The public subnets may be configured to allow inbound traffic from the internet, while the private subnets may be configured to only allow inbound traffic from within the VPC.</p>
<p>Additionally, the network_resources.tf file may include the configuration of an internet gateway, which serves as a gateway to allow traffic to flow between the VPC and the internet. This file may also include the configuration of route tables and their associations, which are necessary for routing traffic between the subnets within the VPC.</p>
<p>A load balancer may also be included in the network_resources.tf file. This load balancer can be configured with a listener and a target group, which is used to direct traffic to specific instances within the VPC. The file may also include the attachment of a target group to the load balancer, which specifies which instances to direct traffic to.</p>
<p>Finally, the network_resources.tf file may include the configuration of an RDS database subnet group. This group specifies which subnets are used for your RDS instances and can be used to ensure that your RDS instances are properly isolated from other resources within the VPC.</p>
<p>Overall, the network_resources.tf file is an essential part of any Terraform project that requires network infrastructure. Properly configuring this file ensures that your application can communicate with other resources both within and outside of the VPC.</p>
<pre><code># Create a vpc
resource &quot;aws_vpc&quot; &quot;two-tier-vpc&quot; {
cidr_block = &quot;10.0.0.0/16&quot;
tags = {
    Name = &quot;two-tier-vpc&quot;
}
}

# Create two public subnets in different AZs
resource &quot;aws_subnet&quot; &quot;two-tier-pub-sub-1&quot; {
vpc_id     = aws_vpc.two-tier-vpc.id
cidr_block = &quot;10.0.0.0/18&quot;
availability_zone = &quot;ap-southeast-1a&quot;
tags = {
    Name = &quot;two-tier-pub-sub-1&quot;
}
}

resource &quot;aws_subnet&quot; &quot;two-tier-pub-sub-2&quot; {
vpc_id     = aws_vpc.two-tier-vpc.id
cidr_block = &quot;10.0.64.0/18&quot;
availability_zone = &quot;ap-southeast-1b&quot;
tags = {
    Name = &quot;two-tier-pub-sub-2&quot;
}
}

# create two private subnets in different AZs
resource &quot;aws_subnet&quot; &quot;two-tier-prv-sub-1&quot; {
vpc_id     = aws_vpc.two-tier-vpc.id
cidr_block = &quot;10.0.128.0/18&quot;
availability_zone = &quot;ap-southeast-1a&quot;
tags = {
    Name = &quot;two-tier-prv-sub-1&quot;
}
}

resource &quot;aws_subnet&quot; &quot;two-tier-prv-sub-2&quot; {
vpc_id     = aws_vpc.two-tier-vpc.id
cidr_block = &quot;10.0.192.0/18&quot;
availability_zone = &quot;ap-southeast-1b&quot;
tags = {
    Name = &quot;two-tier-prv-sub-2&quot;
}
}

# create internet gateway
resource &quot;aws_internet_gateway&quot; &quot;two-tier-igw&quot; {
vpc_id = aws_vpc.two-tier-vpc.id
tags = {
    Name = &quot;two-tier-igw&quot;
}
}

# Create Route table 
resource &quot;aws_route_table&quot; &quot;two-tier-rt&quot; {
vpc_id = aws_vpc.two-tier-vpc.id

route {
    cidr_block = &quot;0.0.0.0/0&quot;
    gateway_id = aws_internet_gateway.two-tier-igw.id
}

tags = {
    Name = &quot;two-tier-rt&quot;
}
}

# Route table association
resource &quot;aws_route_table_association&quot; &quot;two-tier-rt-1&quot; {
subnet_id      = aws_subnet.two-tier-pub-sub-1.id
route_table_id = aws_route_table.two-tier-rt.id
}

resource &quot;aws_route_table_association&quot; &quot;two-tier-rt-2&quot; {
subnet_id      = aws_subnet.two-tier-pub-sub-2.id
route_table_id = aws_route_table.two-tier-rt.id
}

# Create load balancer
resource &quot;aws_lb&quot; &quot;two-tier-alb&quot; {
name               = &quot;two-tier-alb&quot;
internal           = false
load_balancer_type = &quot;application&quot;
security_groups    = [aws_security_group.two-tier-ec2-sg.id]
subnets            = [aws_subnet.two-tier-pub-sub-1.id, aws_subnet.two-tier-pub-sub-2.id]

tags = {
    Environment = &quot;two-tier-alb&quot;
}
}

# Create target group
resource &quot;aws_lb_target_group&quot; &quot;two-tier-lb-tg&quot; {
name     = &quot;two-tier-lb-tg&quot;
port     = 80
protocol = &quot;HTTP&quot;
vpc_id   = aws_vpc.two-tier-vpc.id
}

# Create Load Balancer Listener
resource &quot;aws_lb_listener&quot; &quot;two-tier-lb-listener&quot; {
load_balancer_arn = aws_lb.two-tier-alb.arn
port = &quot;80&quot;
protocol = &quot;HTTP&quot;
default_action {
    type = &quot;forward&quot;
    target_group_arn = aws_lb_target_group.two-tier-lb-tg.arn
}
}

# create target group
resource &quot;aws_lb_target_group&quot; &quot;two-tier-web-loadb-tg&quot; {
name     = &quot;target&quot;
depends_on = [ aws_vpc.two-tier-vpc ]
port     = &quot;80&quot;
protocol = &quot;HTTP&quot;
vpc_id   = aws_vpc.two-tier-vpc.id
}


# attachment
resource &quot;aws_lb_target_group_attachment&quot; &quot;two-tier-web-loadb-tg-attch-1&quot; {
depends_on = [aws_security_group.two-tier-ec2-sg]
target_group_arn = aws_lb_target_group.two-tier-web-loadb-tg.arn
target_id        = aws_instance.two-tier-web-server-1.id
port             = 80
}

resource &quot;aws_lb_target_group_attachment&quot; &quot;two-tier-web-loadb-tg-attch-2&quot; {
depends_on = [aws_security_group.two-tier-ec2-sg]
target_group_arn = aws_lb_target_group.two-tier-web-loadb-tg.arn
target_id        = aws_instance.two-tier-web-server-2.id
port             = 80
}

# Subnet group database
resource &quot;aws_db_subnet_group&quot; &quot;two-tier-db-sub&quot; {
name = &quot;two-tier-db-sub&quot;
subnet_ids = [aws_subnet.two-tier-prv-sub-1.id, aws_subnet.two-tier-prv-sub-2.id]
}
</code></pre>


<footer class="footline">
	
</footer>

        
            </div> 
        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/level-second/page-2-a/" title="Create provider.tf file"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/level-second/page-2-c/" title="Create security resources.tf file" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1725202854"></script>
    <script src="/js/perfect-scrollbar.min.js?1725202854"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1725202854"></script>
    <script src="/js/jquery.sticky.js?1725202854"></script>
    <script src="/js/featherlight.min.js?1725202854"></script>
    <script src="/js/highlight.pack.js?1725202854"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1725202854"></script>
    <script src="/js/learn.js?1725202854"></script>
    <script src="/js/hugo-learn.js?1725202854"></script>
    
        
            <script src="/mermaid/mermaid.js?1725202854"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

